\heading{5. PERFORMANCE AND APPLICATIONS}

This section contains graphs of sample {\tt MQSI} results given various
data configurations. Execution times for Algorithms 1 and 4 are given; the
total execution time of {\tt MQSI} is utterly dominated by the time for a
banded linear system solve computing the $3n$ $B$-spline coefficients,
which is ${\cal O}(n)$.  The files {\tt sample\_main.f90} and {\tt
sample\_main.dat} accompanying the subroutine {\tt MQSI} illustrate Fortran
2003 subroutine usage with optional arguments and data points from a file.
Compilation instructions and the full package contents are specified in
the {\tt README} file.

\topinsert
\centerline{\epsfxsize=4truein \epsffile{vis/2-piecewise-polynomial.eps}}
\centerline{\epsfxsize=4truein \epsffile{vis/3-large-tangent.eps}}
\centerline{\epsfxsize=4truein \epsffile{vis/4-signal-decay.eps}}
{\narrower\noindent\rmVIII Fig.\ 2.
{\ttVIII MQSI} results for three of the functions in the included test
suite. The {\itVIII piecewise polynomial} function (top) shows the
interpolant capturing local linear segments, local flats, and
alternating extreme points. The {\itVIII large tangent} (middle)
problem demonstrates outcomes on rapidly changing segments of data.
The {\itVIII signal decay} (bottom) alternates between extreme values
of steadily decreasing magnitude.
\par}
\vskip 6mm
\centerline{\epsfxsize=4truein \epsffile{vis/5-real-data.eps}}
{\narrower\noindent\rmVIII Fig.\ 3.
{\ttVIII MQSI} results when approximating the cumulative distribution
function of system throughput (bytes per second) data for a computer
with a 3.2 GHz CPU performing file read operations from Cameron et al.
[2019]. The empirical distribution of 30 thousand throughput values is
shown in the red dashed line, while the solid line with stylized
markers denotes the approximation made with MQSI given equally spaced
empirical distribution points from a sample of size 100.
\par}
\endinsert

\topinsert
\centerline{\epsfxsize=4truein \epsffile{vis/6-random-monotone.eps}}
{\narrower\noindent\rmVIII  Fig.\ 4.
The {\itVIII random monotone} test poses a particularly challenging
problem with large variations in slope. Notice that despite drastic
shifts in slope, the resulting monotone quintic spline interpolant
provides smooth and reasonable estimates to function values between data.
\par}
\iffalse
\vskip 15mm
\centerline{\epsfxsize=4truein \epsffile{vis/7-runtimes-10.eps}}
\centerline{\epsfxsize=4truein \epsffile{vis/8-runtimes-100.eps}}
{\everymath={\scriptstyle} \narrower\noindent\rmVIII Fig.\ 5.
Median total runtime of the routine {\ttVIII MQSI} for number of data points
$n=10$
to 100 (top) and $n=100$ to 1000 (bottom), generated from 100
repeated trials averaged over $14$ different testing functions. The
timings are colored by major algorithmic component, but the vast
majority of execution time is spent solving the banded linear system
of equations in the {\ttVIII FIT\_SPLINE} routine. The runtimes for
the quadratic facet (Algorithm 1) take roughly one microsecond
($10^{-6}$ seconds) per breakpoint, while the binary search
(Algorithm 4) takes roughly four microseconds per breakpoint.
\par}
\fi
\endinsert

Throughout, all visuals have points that are stylized by local
monotonicity conditions. Blue circles denote extreme points, purple
squares are in {\it flat} regions with no change in function value,
red down triangles are monotone decreasing, and green up triangles are
monotone increasing.

Figure 2 offers examples of the interpolating splines produced by the
routine {\tt MQSI} on various hand-crafted sets of data. These same
data sets are used for testing local installations in the provided
program {\tt test\_all.f90}. Notice that the quadratic facet model
perfectly captures the local linear segments of data in the piecewise
polynomial test for Figure 2. Figure 3 depicts an approximation of a
cumulative distribution function made by {\tt MQSI} on a computer
systems application by Cameron et al. [2019] that studies the
distribution of throughput (in bytes per second) when reading files
from a storage medium. Figure 4 provides a particularly difficult
monotone interpolation challenge using randomly generated monotone
data.

On a computer running MacOS 10.15.5 with a 2 GHz Intel Core i5 CPU, the
quadratic facet (Algorithm 1) takes roughly one microsecond ($10^{-6}$
seconds) per breakpoint, while the binary search (Algorithm 4) takes roughly
four microseconds per breakpoint; these times were generated from 100
repeated trials averaged over 14 different testing functions.  The vast
majority of execution time is spent solving the banded linear system of
equations in the routine {\tt FIT\_SPLINE} for the $B$-spline coefficients.
For large problems ($n > 100$) it would be faster to construct splines
over intervals independently (each interval requiring a $6 \times 6$ linear
system to be solved for a local $B$-spline representation, or the
construction of the Newton form of the interpolating polynomial from the
derivative information at the endpoints), however the single linear system
is chosen here for the decreased redundancy in the spline description. An
optional argument to {\tt MQSI} returns the derivative information at the
breakpoints (interval endpoints) for the Newton form of the interpolating
polynomial (piece of $Q(x)$) over each interval.
